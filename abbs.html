<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            background-color: rgb(203, 223, 224);
        }

        div.border * {
            font-family: Verdana;
            font-size: 8pt;
        }

        div.border {
            border: 1px solid #000;
            width: 268px;
            height: 100px;
            overflow-y: scroll;
        }

        .container {
            display: grid;
            grid-template-columns: 1fr 1fr 0.7fr 1fr;
            grid-template-rows: 0.01fr 0.001fr;
            gap: 4px 4px;
            grid-auto-flow: row;
            grid-template-areas:
                "canvas canvas canvas input"
                "buttons buttons buttons buttons"
                "male male female female";
            margin: 1rem;
            padding: 2%;
            border-radius: 5px;
            box-shadow: 5px 5px 10px grey;
            background-color: green;
        }

        .canvas {
            margin: 1rem;
            padding: 1rem;
            grid-area: canvas;
        }

        button {
            border-radius: 5px;
            outline-color: transparent;
            height: 40px;
            width: 50px;
        }

        button:hover {
            background-color: bisque;
        }

        .input {
            display: grid;
            grid-template-columns: 0.3fr 2.4fr 0.3fr;
            grid-template-rows: 0.1fr .01fr 0.1fr;
            gap: 0px 0px;
            grid-auto-flow: row;
            grid-template-areas:
                ". . ."
                ". inputArea ."
                ". . .";
            grid-area: input;
        }

        .inputArea {
            grid-area: inputArea;
        }

        .buttons {
            justify-self: center;
            align-self: center;
            grid-area: buttons;
        }


        /* edit */
        .wrapper {
            background-color: green;
        }

        .wrapper a {
            display: inline-block;
            text-decoration: none;
            padding: 5px;
            background-color: #ccc;
            border-radius: 5px;
            color: black;
            font-family: Verdana, Geneva, Tahoma, sans-serif;
        }

        .modal {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(77, 77, 77, .7);
            transition: all .4s;
        }

        .modal:target {
            visibility: visible;
            opacity: 1;
        }

        .modal__content {
            border-radius: 5px;
            position: relative;
            width: 400px;
            max-width: 90%;
            background: #fff;
            padding: 1em 2em;
        }

        .modal__close {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #585858;
            text-decoration: none;
        }

        /* edit */
        .inputAreat {
            background-color: whitesmoke;
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            box-shadow: 5px 5px 10px rgb(47, 47, 47);

        }

        .age {
            width: 20px;
        }

        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Firefox */
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>

<body>
    <img id="sheep" src="sheep.png" hidden>
    <img id="sheepG" src="sheepG.png" hidden>
    <img id="onion" src="cat.png" hidden>
    <img id="otherSheep" src="sheepP.png" hidden>

    <div class="container">
        <div class="canvas">
            <!-- edit -->
            <div class="wrapper">
                <a href="#modal">Rules</a>
            </div>
            <div id="modal" class="modal">
                <div class="modal__content">
                    <h2>Rules</h2>
                    <p>
                    <ul>
                        <li>Click anywhere to add sheep.</li>
                        <li>For sheep, you must provide a name , sex, and age.</li>
                        <li>You can brand/breed sheep by clicking on them.</li>
                        <li>You need to click two sheep to breed.</li>
                        <li>When sheep get to 15, they will be given two pair of boots, a bacpack and hat. They will
                            then go off to travel the world.</li>
                    </ul>
                    <p>Thanks to:</p>
                    <ul>
                        <li>Google</li>
                        <li>Youtube</li>
                        <li>w3schools/Stackoverflow</li>
                    </ul>
                    </p>
                    <h2>
                        Other Rules
                    </h2>
                    <p>
                        Branded sheep are not supposed to breed , I am not doing that.
                    </p>
                    <p> Onion the cat will slip under the fence now and again. She will invite sheep from other farms to
                        stay. She will come and go as she feels, she is a cat.
                    </p>
                    <a href="#" class="modal__close">&times;</a>
                </div>
            </div>
            <!-- edit -->

            <canvas id="canvas" width="500px" height="500px" style="border:1px solid white; cursor: none;">
            </canvas>
        </div>
        <div class="input">
            <div class="inputAreat">
                Sheep name
                <input type="text" name="sheepName" id="sheepName">
                <br>
                <br>
                Gender
                <br>
                <input type="radio" id="sex" name="sex" value="1">
                <label for="sex">male</label>
                <input type="radio" id="sex" name="sex" value="0">
                <label for="sex">female</label>
                <br>
                <br>
                Age
                <input type="tel" class="age" name="age" id="age" maxlength="2" min="1" max="14">
                <br>
                <br>
                <button id="addBut" onclick="playAudio('sheep.mp3')">Add</button>
                <br>
                <br>
                <hr>
                <br>
                <button>breed</button>
            </div>
        </div>

    </div>

    <div id="listy"></div>
    <div id="listy2"></div>

</body>

<script>
    d = document
    let sheeps = []
    let img = d.getElementById("sheep")
    let imgG = d.getElementById("sheepG")

    let onion = d.getElementById("onion")
    let otherSheep = d.getElementById("otherSheep")

    let canvas = d.getElementById("canvas");
    let ctx = canvas.getContext("2d")
    let x1, y1, x2, y2, posx, posy, br
    let q = 0


    const types = {
        0: img,
        1: onion,
        2: otherSheep,
        3: imgG
    }

    const rando = (i) => Math.floor(Math.random() * i)

    const playAudio = (url) => {
        new Audio(url).play();
    }


    const draw = (e) => {
        var pos = getMousePos(canvas, e);
        posx = pos.x;
        posy = pos.y;

        // d.getElementById("listy").innerText = posx
    }

    function getMousePos(canvas, evt) {
        let rect = canvas.getBoundingClientRect();
        return {
            x: (evt.clientX - rect.left) / (rect.right - rect.left) * canvas.width,
            y: (evt.clientY - rect.top) / (rect.bottom - rect.top) * canvas.height
        };
    }

    const colourRect = (leftX, topY, width, height, drawColor) => {
        ctx.fillStyle = drawColor
        ctx.fillRect(leftX, topY, width, height)
    }



    const box1 = () => {
        sheepName = d.getElementById("sheepName").value
        sex = d.querySelector('input[name="sex"]:checked').value
        age = d.getElementById("age").value
        if (q > 9) {
            sheepName = "Onion"
            sex = 1
            age = 6
            br = 1
            q = 0
        } else {
            br = 0
            q += 1
        }
        sheeps.push([sheepName, sex, age, br, rando(499), rando(499), rando(10) > 5 ? 1 : -1, rando(10) > 5 ? 1 : -1])
    }

    const moveS = (sheepX, sheepY, x2, y2, brand) => {
        // i > 500 ? i = 0 : i += 0.5
        if (sheepX > 460) x2 = -1
        if (sheepX < 1) x2 = Math.random() * 1
        sheepX = x2 + sheepX
        if (sheepY > 460) y2 = -1
        if (sheepY < 1) y2 = Math.random() * 1
        sheepY = y2 + sheepY
        ctx.drawImage(types[brand], sheepX, sheepY)
        // sheep to mouse
        ctx.drawImage(otherSheep, posx, posy)
        return [sheepX, sheepY, x2, y2]
    }

    const moveSA = () => {
        colourRect(0, 0, 500, 500, "green")
        sheeps.forEach((e, i) => {
            [sheeps[i][4], sheeps[i][5], sheeps[i][6], sheeps[i][7]] = moveS(e[4], e[5], e[6], e[7], e[3])
        })
    }
    const clicky = () => {
        sheeps.forEach(e =>{
    
    
    if (e[4] >= posx - 20 && e[4] <= posx + 20 &&e[5] >= posy - 20 && e[5] <= posy + 20) { 


        d.getElementById("listy2").innerText=e[0]
    }
    
    
    
        })


        // d.getElementById("listy2").innerText = "mouse"



    }


    d.getElementById("addBut").addEventListener("click", box1)
    window.addEventListener('mousemove', draw, false);
    window.addEventListener('click', clicky, false)
    setInterval(moveSA, 40);
</script>

</html>